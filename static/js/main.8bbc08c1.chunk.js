(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{194:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(14),o=n.n(i),c=(n(84),n(75)),s=n(15),u=n(16),l=(n(85),n(86),n(10)),d=n.n(l),h=n(22),f=n(17),v=n(18),m=n(20),p=n(19),g=n(21),b=n(6),x=n(46),w=n.n(x),E=n(2),O=n(3),j="#edf1f3",y="#dbdbdb",S="#d9dfe3",I="4px",C=("1px solid ".concat(y),"#D62828"),k="#094074",P="#FFDD4A",A="#dbe9f9",L="#4990e2",R="#094074",z="#fff",D={huge:"".concat(24,"px"),bigger:"".concat(18,"px"),big:"".concat(16,"px"),normal:"".concat(14,"px"),small:"".concat(12,"px"),smaller:"".concat(10,"px")},M={subUnit:"".concat(4,"px"),unit:"".concat(8,"px"),tapSize:"".concat(40,"px"),desktopWidthMax:"1600px",sidebarWidth:"204px",inputHeight:"34px"},N={"-sm":M.negSubUnit,"-md":"-".concat(12,"px"),"-lg":"-".concat(16,"px"),"-xlg":"-".concat(24,"px"),sm:M.subUnit,md:"".concat(12,"px"),lg:"".concat(16,"px"),xlg:"".concat(24,"px")};function T(){var e=Object(E.a)(["\n  margin: ",";\n  padding: ",";\n"]);return T=function(){return e},e}var B=function(e,t){var n=t||e;return n?N[n]||n:0},U=function(e,t,n,r,a){var i=B(e,t),o=B(e,n),c=B(e,r),s=B(e,a);return"".concat(i," ").concat(o," ").concat(c," ").concat(s)},F=function(e){return U(e.margin,e.marginTop,e.marginRight,e.marginBottom,e.marginLeft)},W=O.a.div(T(),F,function(e){return U(e.padding,e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft)});function G(){var e=Object(E.a)(["\n  display: ",";\n  align-items: ",";\n  justify-content: ",";\n  flex-direction: ",";\n"]);return G=function(){return e},e}var H=Object(O.a)(W)(G(),function(e){return e.inline?"inline-flex":"flex"},function(e){return e.alignItems||"initial"},function(e){return e.justifyContent||"initial"},function(e){return e.flexDirection||"initial"});H.displayName="Flex";var J=H;function V(){var e=Object(E.a)(["\n  overflow-x: ",";\n  overflow-y: ",";\n  display: ",";\n  height: ",";\n  max-height: ",";\n  min-height: ",";\n  width: ",";\n  max-width: ",";\n  min-width: ",";\n  background: ",";\n  border: ",";\n  border-radius: ",";\n  box-shadow: ",";\n  color: ",";\n  text-align: ",";\n  -webkit-overflow-scrolling: touch;\n"]);return V=function(){return e},e}var X="#dbdbdb",Y={color:X,darkColor:"#3d464b",radius:"4px",shorthand:"1px solid ".concat(X)},K=Object(O.a)(J)(V(),function(e){var t=e.overflowX;return t||"initial"},function(e){var t=e.overflowY;return t||"initial"},function(e){var t=e.display;return t||"block"},function(e){var t=e.height;return t||"auto"},function(e){var t=e.maxHeight;return t||"initial"},function(e){var t=e.minHeight;return t||"initial"},function(e){var t=e.width;return t||"auto"},function(e){var t=e.maxWidth;return t||"initial"},function(e){var t=e.minWidth;return t||"initial"},function(e){var t=e.background;return t||"none"},function(e){return e.border?Y.shorthand:"0"},function(e){var t=e.borderRadius;return t||0},function(e){var t=e.boxShadow;return t||"none"},function(e){var t=e.color;return t||"inherit"},function(e){var t=e.textAlign;return t||"initial"});function _(){var e=Object(E.a)(["\n  position: relative;\n"]);return _=function(){return e},e}var q=Object(O.a)(K)(_());function Q(){var e=Object(E.a)(["\n  left: 0;\n  overflow: hidden;\n  position: absolute;\n  pointer-events: none;\n  top: 0;\n  width: 100%;\n  height: auto;\n"]);return Q=function(){return e},e}var Z=Object(O.a)(K)(Q());function $(){var e=Object(E.a)(["\n  cursor: url(./coin.png) 12 12, pointer;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n"]);return $=function(){return e},e}var ee=O.a.div($()),te=function(e){for(var t={left:0,top:0},n=e.getBoundingClientRect();e;)t.top+=e.offsetTop,t.left+=e.offsetLeft,e=e.offsetParent;var r=t.left-n.left,a=t.top-n.top;return{left:r<0?t.left+Math.abs(r):t.left-Math.abs(r),top:a<0?t.top+Math.abs(a):t.top-Math.abs(a)}};var ne=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(m.a)(this,Object(p.a)(t).call(this,e))).scratching=w()(function(e){if(e.preventDefault(),n.offset=te(n.refs.canvas),n.updatePos(e),n.ctx.globalCompositeOperation="destination-out",n.ctx.save(),"brush"===n.props.brush){if(null===n.brushImage){var t=new Error("argument img is not a node IMG");return void console.error(t.message)}var r=Math.atan2(n.yPos,n.xPos);n.ctx.translate(n.xPos,n.yPos),n.ctx.rotate(r),n.ctx.drawImage(n.brushImage,-n.brushImage.width/2,-n.brushImage.height/2)}else n.ctx.beginPath(),n.ctx.arc(n.xPos+n.radius,n.yPos+n.radius,n.radius,0,2*Math.PI,!1),n.ctx.fill(),n.ctx.closePath();n.ctx.restore(),n.updatePercentScratched()},40),n.mouseScratch=function(e){e.preventDefault();var t=n.refs.canvas,r=n.scratching;t.addEventListener("mousemove",r),document.body.addEventListener("mouseup",function e(){t.removeEventListener("mousemove",r),document.body.removeEventListener("mouseup",e)})},n.touchScratch=function(e){e.preventDefault();var t=n.refs.canvas,r=n.scratching;t.addEventListener("touchmove",r),document.body.addEventListener("touchend",function e(){t.removeEventListener("touchmove",r),document.body.removeEventListener("touchend",e)})},n.recalculateOffset=w()(function(){return n.offset=te(n.refs.canvas)},40),n.ctx=null,n.offset=null,n.radius=16,n.xPos=null,n.yPos=null,n.state={foregroundRendered:!1,percentScratched:0,isCleared:!1},n.scratching=n.scratching.bind(Object(b.a)(Object(b.a)(n))),n}return Object(g.a)(t,e),Object(v.a)(t,[{key:"renderForeground",value:function(){var e=this,t=this.props,n=t.imgURL;if(t.isCleared)this.setState({foregroundRendered:!0});else{var r=this.refs.canvas,a=r.width,i=r.height;if(n){var o=new Image;o.src=n,o.onload=function(){e.ctx.drawImage(o,0,0,a,i),e.setState({foregroundRendered:!0})}}else this.ctx.fillStyle="silver",this.ctx.fillRect(0,0,a,i),this.setState({foregroundRendered:!0})}}},{key:"updatePos",value:function(e){if("mousemove"===e.type)return this.xPos=e.clientX-this.offset.left,void(this.yPos=e.clientY-this.offset.top);"touchmove"===e.type&&(this.xPos=e.touches[0].clientX-this.offset.left-this.radius/2,this.yPos=e.touches[0].clientY-this.offset.top-this.radius/2)}},{key:"updatePercentScratched",value:function(){for(var e=0,t=this.refs.canvas,n=t.width,r=t.height,a=this.props,i=a.subRectRatio,o=void 0===i?1:i,c=a.percentToClear,s=void 0===c?50:c,u=this.ctx.getImageData(Math.round((1-o)/2*n),Math.round((1-o)/2*r),Math.round(o*n),Math.round(o*r)),l=u.data.length,d=0;d<l;d+=4)0===u.data[d]&&0===u.data[d+1]&&0===u.data[d+2]&&0===u.data[d+3]&&e++;var h=Math.round(e/(o*o*n*r)*1e4)/100;this.setState({percentScratched:h}),h>=s&&this.clearCard()}},{key:"clearCard",value:function(){var e=this.props.onClear,t=void 0===e?function(){}:e;this.refs.canvas.removeEventListener("mousedown",this.mouseScratch),this.refs.canvas.removeEventListener("touchstart",this.touchScratch),window.removeEventListener("resize",this.recalculateOffset),window.removeEventListener("scroll",this.recalculateOffset),this.setState({isCleared:!0}),t()}},{key:"componentDidMount",value:function(){var e,t=this;"brush"===this.props.brush&&(e="/brush.png",new Promise(function(t,n){var r=new Image;r.crossOrigin="Anonymous",r.onload=function(){t(r)},r.src=e,r.onerror=function(t){var r=new Error("Image ".concat(e," is not loaded."));n(r)}})).then(function(e){t.brushImage=e}),this.ctx=this.refs.canvas.getContext("2d"),this.renderForeground(),this.refs.canvas.addEventListener("mousedown",this.mouseScratch),this.refs.canvas.addEventListener("touchstart",this.touchScratch),window.addEventListener("resize",this.recalculateOffset),window.addEventListener("scroll",this.recalculateOffset)}},{key:"componentDidUpdate",value:function(e){this.props.isCleared!==e.isCleared&&this.props.isCleared&&this.clearCard()}},{key:"componentWillUnmount",value:function(){this.state.isCleared||(this.refs.canvas.removeEventListener("mousedown",this.mouseScratch),this.refs.canvas.removeEventListener("touchstart",this.touchScratch),window.removeEventListener("resize",this.recalculateOffset),window.removeEventListener("scroll",this.recalculateOffset))}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.height,r=e.width,i=this.state,o=i.foregroundRendered,c=i.isCleared;return a.a.createElement("div",null,a.a.createElement(q,{width:"".concat(r,"px"),height:"".concat(n,"px")},o&&a.a.createElement(Z,{display:"flex",justifyContent:"center",alignItems:"center"},a.a.Children.only(t)),!c&&a.a.createElement(ee,null,a.a.createElement("canvas",{onContextMenu:function(e){return e.preventDefault()},ref:"canvas",width:"".concat(r,"px"),height:"".concat(n,"px")}))))}}]),t}(a.a.Component);function re(){var e=Object(E.a)(["\n  flex: ",";\n  min-width: 0;\n"]);return re=function(){return e},e}var ae=Object(O.a)(W)(re(),function(e){return e.flex||"1 1 auto"}),ie="cleared",oe="imgUrl",ce="prizeId",se="sessionId",ue=function(e){var t=e.sessionId,n=e.prize,r=oe,a=ce,i=se;window.localStorage.getItem(i)!==t&&(window.localStorage.clear(),window.localStorage.setItem(i,t),window.localStorage.setItem(a,n.id),window.localStorage.setItem(r,n.imageSrc))},le=function(e){function t(){var e;return Object(f.a)(this,t),(e=Object(m.a)(this,Object(p.a)(t).call(this))).state={loaded:!1,isCleared:!1},e.handleCleared=e.handleCleared.bind(Object(b.a)(Object(b.a)(e))),e}return Object(g.a)(t,e),Object(v.a)(t,[{key:"handleCleared",value:function(){var e;e=!0,window.localStorage.setItem(ie,e)}},{key:"componentDidMount",value:function(){var e=Object(h.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/prizes",{method:"post",body:JSON.stringify({sessionId:window.localStorage.getItem(se)||""}),headers:{"Content-type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,ue(n),this.setState({loaded:!0}),Boolean(window.localStorage.getItem(ie))&&this.setState({isCleared:!0});case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.loaded,n=e.isCleared,r=window.localStorage.getItem(oe)||"/background.gif";return t&&a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},a.a.createElement("div",{className:"Game"},a.a.createElement("h4",{className:"card-header"},"THANKS FOR PARTICIPATING!"),a.a.createElement(J,null,a.a.createElement(ae,{margin:"sm"},a.a.createElement(ne,{isCleared:n,brush:"brush",width:300,height:300,percentToClear:50,subRectRatio:.7,imgURL:"./overlay.gif",onClear:this.handleCleared},a.a.createElement("img",{width:300,height:300,src:r,alt:"scratch card"})))))))}}]),t}(a.a.Component),de=n(49),he=n.n(de);function fe(){var e=Object(E.a)(["\n  width: ",";\n  padding: 0;\n  border: 1px solid ",";\n  border-radius: ",";\n  background: ",";\n  outline: none;\n  color: ",";\n  vertical-align: middle;\n  transition: 0.2s ease-out all;\n  -webkit-appearance: none;\n  &:active,\n  &:focus {\n    background: ",";\n    color: ",";\n  }\n\n  &[disabled] {\n    background: ",";\n    border-color: ",";\n    color: ",";\n  }\n\n  ",";\n\n  ",";\n\n  ",";\n"]);return fe=function(){return e},e}var ve=O.a.button.attrs({type:"button"})(fe(),function(e){return e.fullWidth?"100%":"auto"},L,I,z,L,j,L,z,S,S,function(e){return e.circle&&"\n    border-radius: 100%;\n  "},function(e){return e.pill&&"\n    border-width: 3px;\n    border-radius: ".concat(M.tapSize,";\n  ")},function(e){return e.raised&&"\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);\n    &:active {\n      box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);\n    }\n  "});function me(){var e=Object(E.a)(["\n  ",";\n  ",";\n  ",";\n  ",";\n"]);return me=function(){return e},e}function pe(){var e=Object(E.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-width: ","px;\n  min-height: ","px;\n  padding: "," ",";\n  font-family: ",";\n  font-weight: ",";\n  text-align: center;\n"]);return pe=function(){return e},e}var ge=O.a.div(pe(),64,34,M.unit,N.md,"'Roboto', sans-serif",400),be={sm:"24px",md:"32px",lg:"44px"},xe=Object(O.a)(ge)(me(),function(e){var t=e.size;return t&&"\n    min-width: ".concat(be[t]?be[t]:"".concat(64,"px"),";\n    min-height: ").concat(be[t]?be[t]:"".concat(34,"px"),";\n    padding-right: ").concat(N.xlg,";\n    padding-left: ").concat(N.xlg,";\n  ")},function(e){return e.leftAligned&&"\n    text-align: left;\n    justify-content: flex-start;\n  "},function(e){var t=e.circle,n=e.size;return t&&"\n    min-width: ".concat(be[n]?be[n]:"44px",";\n    min-height: ").concat(be[n]?be[n]:"44px",";\n    padding: 0;\n\n    ").concat("sm"===n&&"\n      svg {\n        width: 16px;\n        height: 16px;\n      }\n    ","\n  ")},function(e){return e.pill&&"\n    padding-right: ".concat(M.tapSize,";\n    padding-left: ").concat(M.tapSize,";\n    font-size: ").concat(D.small,";\n    letter-spacing: 0.05em;\n  ")});function we(){var e=Object(E.a)(["\n  ",";\n"]);return we=function(){return e},e}var Ee=Object(O.a)(function(e){var t=e.children,n=e.circle,r=e.leftAligned,i=e.pill,o=e.size;return a.a.createElement(ve,Object.assign({},e,{children:null}),a.a.createElement(xe,{circle:n,size:o,leftAligned:r,pill:i},t))})(we(),F);function Oe(){var e=Object(E.a)(["\n  background: ",";\n  color: ",";\n\n  &:focus {\n    background: ",";\n    color: ",";\n  }\n\n  &:active {\n    background: ",";\n    color: ",";\n  }\n  &[disabled] {\n    background: ",";\n    border-color: ",";\n    color: ",";\n  }\n"]);return Oe=function(){return e},e}var je=Object(O.a)(Ee)(Oe(),L,z,L,z,R,z,A,A,z);function ye(){var e=Object(E.a)(["\n  ",";\n"]);return ye=function(){return e},e}var Se=Object(O.a)(je)(ye(),function(e){return e.outline&&"\n  border-color: ".concat(z,";\n")}),Ie=n(71),Ce={AVAILABLE:C,ASSIGNED:P,REDEEMED:k},ke=function(e){var t=e.inventory,n=void 0===t?{}:t,r={labels:["Available","Assigned","Redeemed"],datasets:[{data:[n.available,n.assigned,n.redeemed],backgroundColor:[Ce.AVAILABLE,Ce.ASSIGNED,Ce.REDEEMED],hoverBackgroundColor:[Ce.AVAILABLE,Ce.ASSIGNED,Ce.REDEEMED]}]},i={legend:{labels:{fontColor:z,fontSize:16}}};return a.a.createElement(W,{margin:"md"},a.a.createElement(Ie.a,{width:250,height:250,data:r,options:i}))},Pe=function(e){var t=e.id,n=e.imageSrc,r=e.inventory,i=e.name,o=e.redeemPrize;return a.a.createElement(ae,{margin:"sm"},a.a.createElement("h5",null,i),a.a.createElement("img",{width:250,height:250,src:n,alt:"prize item"}),a.a.createElement(ke,{inventory:r}),a.a.createElement(Se,{onClick:function(){return o(t)}},"Redeem One Prize"))},Ae=function(e){function t(){var e;return Object(f.a)(this,t),(e=Object(m.a)(this,Object(p.a)(t).call(this))).resetAssigned=he()(Object(h.a)(d.a.mark(function t(){var n,r,a,i;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/prizes/reset",{method:"post"});case 2:return n=t.sent,t.next=5,n.json();case 5:r=t.sent,a=r.inventory,i=r.resetCount,Object(u.a)("Reset ".concat(i," prizes from assigned to available!")),e.setState({inventory:a});case 10:case"end":return t.stop()}},t)})),400),e.redeemPrize=he()(function(){var t=Object(h.a)(d.a.mark(function t(n){var r,a,i,o;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/prizes/".concat(n,"/redeem"),{method:"post"});case 2:return r=t.sent,t.next=5,r.json();case 5:a=t.sent,i=a.inventory,(o=a.error)?Object(u.a)(o):(e.setState({inventory:i}),Object(u.a)("One ".concat(i[n].name," has been redeemed!")));case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),400),e.state={inventory:{},successRate:100,intervalId:null},e.updateStatus=e.updateStatus.bind(Object(b.a)(Object(b.a)(e))),e.resetAssigned=e.resetAssigned.bind(Object(b.a)(Object(b.a)(e))),e.redeemPrize=e.redeemPrize.bind(Object(b.a)(Object(b.a)(e))),e}return Object(g.a)(t,e),Object(v.a)(t,[{key:"updateStatus",value:function(){var e=Object(h.a)(d.a.mark(function e(){var t,n,r,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/status");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,r=n.inventory,a=n.successRate,this.setState({inventory:r,successRate:a});case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.updateStatus();var e=setInterval(this.updateStatus,5e3);this.setState({intervalId:e})}},{key:"componentWillUnmount",value:function(){clearInterval(this.state.intervalId)}},{key:"render",value:function(){var e=this,t=this.state,n=t.inventory;t.successRate;return a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},n&&a.a.createElement(a.a.Fragment,null,a.a.createElement(J,{alignItems:"center",margin:"sm"},Object.values(n).map(function(t){return a.a.createElement(Pe,Object.assign({},t,{redeemPrize:e.redeemPrize}))})),a.a.createElement(Se,{onClick:this.resetAssigned},"Reset Assigned Prizes"))))}}]),t}(a.a.Component);u.a.configure({autoClose:8e3,className:"toast-container",position:u.a.POSITION.TOP_CENTER});var Le=function(){return a.a.createElement(c.a,null,a.a.createElement(s.a,{exact:!0,path:"/",component:le}),a.a.createElement(s.a,{exact:!0,path:"/admin",component:Ae}))};o.a.render(a.a.createElement(Le,null),document.getElementById("root"))},79:function(e,t,n){e.exports=n(194)},84:function(e,t,n){},85:function(e,t,n){}},[[79,1,2]]]);
//# sourceMappingURL=main.8bbc08c1.chunk.js.map